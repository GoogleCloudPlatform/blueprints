# API Activation
apiVersion: serviceusage.cnrm.cloud.google.com/v1beta1
kind: Service
metadata:
  name: my-project-id-pubsub # kpt-set: ${project-id}-pubsub
  namespace: projects
  annotations:
    cnrm.cloud.google.com/deletion-policy: "abandon"
    cnrm.cloud.google.com/disable-dependent-services: "false"
    cnrm.cloud.google.com/project-id: my-project-id # kpt-set: ${project-id}
spec:
  resourceID: pubsub.googleapis.com
---
# Folder Sink to PubSub
apiVersion: logging.cnrm.cloud.google.com/v1beta1
kind: LoggingLogSink
metadata:
  name: 123456789012-pubsubsink # kpt-set: ${org-id}-pubsubsink
  namespace: my-namespace # kpt-set: ${namespace}
spec:
  destination:
    pubSubTopicRef:
      name: pubsub-logexport-dataset # kpt-set: ${topic-name}
  filter: "" # kpt-set: ${filter}
  includeChildren: true
  organizationRef:
    external: "123456789012" # kpt-set: ${org-id}
---
# Pubsub Topic
apiVersion: pubsub.cnrm.cloud.google.com/v1beta1
kind: PubSubTopic
metadata:
  name: pubsub-logexport-dataset # kpt-set: ${topic-name}
  namespace: my-namespace # kpt-set: ${namespace}

# TODO(jcwc): Add support for creating subscribers (either a new blueprint or kpt fn)
