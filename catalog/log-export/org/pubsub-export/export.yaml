apiVersion: serviceusage.cnrm.cloud.google.com/v1beta1 # API Activation
kind: Service
metadata:
  annotations:
    cnrm.cloud.google.com/blueprint: cnrm/pubsub-export/v0.2.0-alpha.1
    cnrm.cloud.google.com/deletion-policy: abandon
    cnrm.cloud.google.com/disable-dependent-services: "false"
    cnrm.cloud.google.com/project-id: my-project-id # {"$kpt-set":"project-id"}
  name: my-project-id-pubsub # {"$kpt-set":"services-pubsub"}
  namespace: projects
spec:
  resourceID: pubsub.googleapis.com
---
apiVersion: logging.cnrm.cloud.google.com/v1beta1 # Folder Sink to PubSub
kind: LoggingLogSink
metadata:
  annotations:
    cnrm.cloud.google.com/blueprint: cnrm/pubsub-export/v0.2.0-alpha.1
  name: 123456789012-pubsubsink # {"$kpt-set":"log-sink-name"}
  namespace: my-namespace # {"$kpt-set":"namespace"}
spec:
  destination:
    pubSubTopicRef:
      name: pubsub-logexport-dataset # {"$kpt-set":"topic-name"}
  filter: "" # {"$kpt-set":"filter"}
  includeChildren: true
  organizationRef:
    external: "123456789012" # {"$kpt-set":"org-id"}
---
apiVersion: pubsub.cnrm.cloud.google.com/v1beta1 # Pubsub Topic
kind: PubSubTopic
metadata:
  annotations:
    cnrm.cloud.google.com/blueprint: cnrm/pubsub-export/v0.2.0-alpha.1
  name: pubsub-logexport-dataset # {"$kpt-set":"topic-name"}
  namespace: my-namespace # {"$kpt-set":"namespace"}
